<section class="admin-panel">

  <div class="panel-view">
    <header class="panel-hero card" id="top" *ngIf="isSection('resumo')">
      <div class="hero-text">
        <p class="eyebrow">{{ saudacao }}, {{ primeiroNome }}!</p>
        <h1>Central Administrativa do SIGE</h1>
        <p class="lead">Monitore indicadores operacionais, mantenha o cadastro em dia e acompanhe a saúde da plataforma em tempo real.</p>
        <div class="hero-tags">
          <span class="tag">Último acesso: {{ ultimoAcesso }}</span>
          <span class="tag success">Uptime {{ estatisticas.uptime }}%</span>
        </div>
      </div>
    </header>

    <section class="panel-section card" id="indicadores-section" *ngIf="isSection('indicadores')">
      <header class="section-header">
        <div>
          <h2>Indicadores principais</h2>
          <p>Acompanhe os números operacionais em tempo real.</p>
        </div>
      </header>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon usuarios">
            <i class="fas fa-users"></i>
          </div>
          <div class="stat-info">
            <h3>{{ estatisticas.usuariosAtivos }}</h3>
            <p>Usuários ativos</p>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon sessoes">
            <i class="fas fa-desktop"></i>
          </div>
          <div class="stat-info">
            <h3>{{ estatisticas.sessoesAbertas }}</h3>
            <p>Sessões abertas</p>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon sistema">
            <i class="fas fa-server"></i>
          </div>
          <div class="stat-info">
            <h3>{{ estatisticas.uptime }}%</h3>
            <p>Disponibilidade</p>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon dados">
            <i class="fas fa-database"></i>
          </div>
          <div class="stat-info">
            <h3>{{ estatisticas.armazenamento }} GB</h3>
            <p>Armazenamento usado</p>
          </div>
        </div>
      </div>
    </section>

    <section class="panel-section card" id="pendencias-section" *ngIf="isSection('pendencias')">
      <header class="section-header">
        <div>
          <h2>Pendências recentes</h2>
          <p>Eventos que requerem atenção do administrador.</p>
        </div>
      </header>
      <div class="activity-list">
        <div class="activity-item" *ngFor="let atividade of atividades">
          <div class="activity-icon" [ngClass]="atividade.tipo">
            <i [class]="atividade.icone"></i>
          </div>
          <div class="activity-info">
            <h4>{{ atividade.titulo }}</h4>
            <p>{{ atividade.descricao }}</p>
            <span class="activity-time">{{ atividade.tempo }}</span>
          </div>
        </div>
      </div>
    </section>

    <section class="panel-section card" id="acoes-section" *ngIf="isSection('acoes') && quickActions.length">
      <header class="section-header">
        <div>
          <h2>Ações rápidas</h2>
          <p>Atalhos sugeridos para manter o ambiente sob controle.</p>
        </div>
      </header>
      <div class="action-grid">
        <button class="action-card" *ngFor="let action of quickActions" (click)="executarAcao(action)">
          <i [class]="action.icon"></i>
          <div>
            <strong>{{ action.label }}</strong>
            <p>{{ action.description }}</p>
          </div>
        </button>
      </div>
    </section>

    <section class="panel-section card" id="usuarios-section" *ngIf="isSection('usuarios')">
      <header class="section-header">
        <div>
          <h2>Gestão de usuários</h2>
          <p>Pesquise, filtre e mantenha os perfis atualizados.</p>
        </div>
        <button class="btn-primary" (click)="novoUsuario()">
          <i class="fas fa-plus"></i>
          Novo usuário
        </button>
      </header>

      <div class="filters">
        <input type="search" placeholder="Buscar por nome ou email" [(ngModel)]="filtroUsuarios">
        <select [(ngModel)]="filtroTipo">
          <option value="">Todos os perfis</option>
          <option value="admin">Administrador</option>
          <option value="diretor">Diretor</option>
          <option value="professor">Professor</option>
          <option value="aluno">Aluno</option>
          <option value="responsavel">Responsável</option>
        </select>
      </div>

      <div class="users-table" *ngIf="usuariosFiltrados.length; else usuariosVazio">
        <table>
          <thead>
            <tr>
              <th>Nome</th>
              <th>Email</th>
              <th>Tipo</th>
              <th>Status</th>
              <th>Último acesso</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let usuario of usuariosFiltrados">
              <td>
                <div class="user-info-cell">
                  <div class="user-avatar-small">{{ usuario.nome.charAt(0) }}</div>
                  {{ usuario.nome }}
                </div>
              </td>
              <td>{{ usuario.email }}</td>
              <td>
                <span class="user-type-badge" [ngClass]="usuario.tipo">
                  {{ (usuario.tipo || 'N/A') | titlecase }}
                </span>
              </td>
              <td>
                <span class="status-badge" [ngClass]="usuario.status">
                  {{ usuario.status | titlecase }}
                </span>
              </td>
              <td>{{ usuario.ultimoAcesso | date:'dd/MM/yyyy HH:mm' }}</td>
              <td>
                <div class="table-actions">
                  <button class="btn-action edit" (click)="editarUsuario(usuario)" title="Editar">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button class="btn-action delete" (click)="confirmarExclusao(usuario)" title="Excluir">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <ng-template #usuariosVazio>
        <div class="empty-state">
          <i class="fas fa-user-slash"></i>
          <p>Nenhum usuário corresponde ao filtro aplicado.</p>
        </div>
      </ng-template>
    </section>
  </div>

  <footer class="panel-footer">
    <div class="user-info" *ngIf="usuario">
      <span>{{ usuario.nome }}</span>
      <button class="link-button" (click)="logout()">
        <i class="fas fa-sign-out-alt"></i>
        Encerrar sessão
      </button>
    </div>
  </footer>
</section>
